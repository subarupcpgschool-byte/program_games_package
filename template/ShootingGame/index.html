<!doctype html>
<html lang="ja">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>縦シューティング（JSだけ）</title>
    <style>
        :root {
            color-scheme: dark;
        }

        body {
            margin: 0;
            background: #000;
            display: grid;
            place-items: center;
            min-height: 100vh;
            font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
        }

        canvas {
            background: #0b0f14;
            border: 1px solid #223044;
            border-radius: 14px;
            box-shadow: 0 18px 40px rgba(0, 0, 0, .45);
        }
    </style>
</head>

<body>
    <canvas id="game" width="480" height="640"></canvas>

    <script>
        (() => {
            // 描画対象HTML要素取得
            const canvas = document.getElementById("game");
            // 2D描画コンテキスト取得
            const ctx = canvas.getContext("2d");

            // ===== ユーティリティ =====
            // 値をmin〜maxの範囲に収める
            const clamp = (v, min, max) => Math.max(min, Math.min(max, v));
            // min〜maxの範囲のランダムな数値を返す
            const rand = (min, max) => Math.random() * (max - min) + min;

            // 矩形同士の当たり判定
            const hitRect = (a, b) => {
                // aとbは{x, y, w, h}の形
            }


            // ===== 入力 =====
            // キー入力管理用Set

            // キー押下時にSetに追加

            // ===== ゲーム状態 =====
            /**
             * 
             * @type {{x:number,y:number,w:number,h:number,speed:number,hp:number}} player 自機
             * @type {Array<{x:number,y:number,w:number,h:number,vy:number}>} bullets 弾
             * @type {Array<{x:number,y:number,w:number,h:number,vy:number,dead?:boolean}>} enemies 敵
             * @type {Array<{x:number,y:number,vx:number,vy:number,life:number}>} particles パーティクル
             * @type {number} score スコア
             * @type {boolean} gameOver ゲームオーバー判定
             */
            let player, bullets, enemies, particles, score, gameOver;
            let lastTime = 0;
            let shootCool = 0;
            let enemySpawn = 0;

            function init() {
                // 自機初期化

                // 弾配列初期化

                // 敵配列初期化

                // パーティクル配列初期化

                // スコア初期化

                // ゲームオーバー判定初期化

            }

            // 敵スポーン処理
            function spawnEnemy() {
            }

            // 爆発エフェクト生成
            function boom(x, y, count = 10) {
                // countの数でパーティクル生成
            }

            // ===== 更新 =====
            function update(dt) {
                // ゲームオーバー時の処理
                if (gameOver) {
                    // Rキーでリスタート

                    return;
                }

                // 自機移動

                // 発射

                // Spaceキーで弾を発射

                // 弾移動

                // 敵スポーン（時間で）

                // 敵移動

                // 当たり判定：弾 vs 敵

                // 死んでいる弾と敵の削除

                // 当たり判定：敵 vs 自機

                // パーティクル

                // 生存しているパーティクルのみに絞る

            }

            // ===== 描画 =====
            function draw() {
                // 背景のクリア

                // スター（簡易）

                // 自機
                // ちょい装飾

                // 弾

                // 敵

                // パーティクル

                // UI

                // ゲームオーバー表示
                if (gameOver) {
                }
            }

            // ===== ループ =====
            function loop(now) {
                // 時間計測

                update(dt);
                draw();

                requestAnimationFrame(loop);
            }

            // 初期化処理実行
            init();
            // アニメーション開始
            requestAnimationFrame(loop);
        })();
    </script>
</body>

</html>